<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DEREKA</title>
</head>
<body style="background-color:MediumSeaGreen;">
    <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);">
        <img src="DerekLogo.png" alt="DEREKA" style="  display: block; margin-left: auto; margin-right: auto;">
        <p style="font-size: 40px; font-style: italic; color:white;" font-style: italic>“Creativity is thinking up new things. Innovation is doing new things.”</p>
        <p style="font-size: 20px; font-style: italic; color:white; text-align: right;">-Theodore Levitt</p>
    </div>
<button id="scanButton">Scan Bluetooth Devices</button>
<div id="deviceSection"></div>

    <script>
        const scanButton = document.getElementById("scanButton");
        const deviceSection = document.getElementById("deviceSection");
        const DEVICE_NAME = "PEzE000001"; // 將此變數替換為您要尋找的設備名稱
        console.log("start 2")        
/*
        scanButton.addEventListener("click", function() {           
          navigator.bluetooth.requestDevice({
            /*filters: [{
              name: DEVICE_NAME
            }]
            acceptAllDevices: true
          })
          .then(
            device => {
            console.log('> Requested ' + device.name + ' (' + device.id + ')');
          })
          .catch(error => {
            console.log(error);
          });
        });
*/

 scanButton.addEventListener("click", function() {
    navigator.bluetooth.requestLEScan({
      filters: [{manufacturerData: {0x004C: {dataPrefix: new Uint8Array([
        0x02, 0x15, // iBeacon identifier.
        0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15  // My beacon UUID.
      ])}}}],
      keepRepeatedDevices: true
    }).then(() => {
      navigator.bluetooth.addEventListener('advertisementreceived', event => {
        let appleData = event.manufacturerData.get(0x004C);
        if (appleData.byteLength != 23) {
          // Isn’t an iBeacon.
          return;
        }
        console.log( appleData.getUint16(18, false);
        console.log( appleData.getUint16(20, false);
        console.log( -appleData.getInt8(22);
        console.log( txPowerAt1m - event.rssi;
     });
    }
            }



        

    </script>
</body>
</html>
